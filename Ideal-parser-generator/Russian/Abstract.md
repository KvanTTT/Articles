# Резюме

ANTLR - один из самых популярных генератор парсеров, поддерживающий рантаймы
Java, C#, Python2, Python3, JavaScript, C++, Swift и Go. ANTLR поддерживает
контекстно-свободные грамматики. Однако в случае, если язык
имеет контекстную зависимость (например, если необходимо знать
значение одного из предыдущих токенов как в
[PHP Heredoc](http://php.net/manual/en/language.types.string.php))
или требуется более расширенная обработка определенных конструкций
(например, [интерполированных строк](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/tokens/interpolated)),
можно воспользоваться *вставками кода* или *семантическими предикатами*.

К сожалению, такие вставки неуниверсальны, т.к. написаны на языке рантайма,
а также они не валидируются на этапе генерации парсера. Если бы они были
таковыми и транслировались в язык рантайма на этапе генерации, то область
применения грамматики существенно расширилась бы. А это, в свою очередь,
привлекло бы больше пользователей для ее дальнейшей доработки и тестирования.

Кроме **универсальных вставок кода**, можно расширить и сам язык описания грамматик,
например с помощью оператора **проверки значения токена**. Он
актуален для языков с большим количеством слов, которые являются ключевыми в
определенных контекстах. Также в языке описания лексера ANTLR не хватает
синтаксиса для удобного задания комментариев.

**Достоверное дерево разбора** - концепция, которая позволяет связывать скрытые
токены с узлами дерева разбора, что удобно не только при рефакторинге, но и при
обнаружении дефектов в исходных кодах (например, [goto fail](https://nakedsecurity.sophos.com/2014/02/24/anatomy-of-a-goto-fail-apples-ssl-bug-explained-plus-an-unofficial-patch))
можно обнаружить не только с помощью анализа потока управления, но и по некорректному отступу).
API сгенерированого кода можно улучшить таким образом, чтобы доступ к ним был таким
же удобным, как во взрослых и специализированных анализаторах кода,
таких как [Roslyn](https://en.wikipedia.org/wiki/.NET_Compiler_Platform).

Также в ANTLR генерируемый код часто не соответствует код-стилю рантайма из-за
различий в **именованиях** и отсутствует возможность реализации **парсеров без токенов**,
что важно для языков без "ошибок" парсинга, например, для Markdown.

В этой статье подробно разъясняются вышеупомянутые и другие проблемы, и описаны
способы их решения. В качества доказательства актуальности, для каждой проблемы
приведены одна или более открытых issues на гитхабе. Кроме того, описывается
путь развития инфраструктуры парсеров на базе ANTLR в целом с помощью реализации
онлайн-обозревателя и редактора грамматик.

Генератор парсеров с такими решенными проблемами и реализованным фичами если
и не будет идеальным, то будет очень близок к такому!